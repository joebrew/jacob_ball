# Create plotting function
hamster_plot <- function(data = dat,
hamsterID = NULL,
swabType = "oral",
var = "Ct"){
# Subset the data
new_data <- dat[which(dat$hamsterID == hamsterID &
dat$swabType == "oral"),]
# Extract the plotting variable of interest
new_var <- dat[,var]
# Assign x, y, and color
x <- new_data$dpi
y <- new_var
color <- new_data$color
# Plot
plot(x = x,
y = y,
col = color)
}
# Create plotting function
hamster_plot <- function(data = dat,
hamsterID = 3,
swabType = "oral",
var = "Ct"){
# Subset the data
new_data <- dat[which(dat$hamsterID == hamsterID &
dat$swabType == "oral"),]
# Extract the plotting variable of interest
new_var <- dat[,var]
# Assign x, y, and color
x <- new_data$dpi
y <- new_var
color <- new_data$color
# Plot
plot(x = x,
y = y,
col = color)
}
hamster_plot()
hamster_plot <- function(data = dat,
hamsterID = 3,
swabType = "oral",
var = "Ct"){
# Subset the data
new_data <- dat[which(dat$hamsterID == hamsterID &
dat$swabType == "oral"),]
# Extract the plotting variable of interest
new_var <- new_data[,var]
# Assign x, y, and color
x <- new_data$dpi
y <- new_var
color <- new_data$color
# Plot
plot(x = x,
y = y,
col = color)
}
hamster_plot()
str(dat)
hist(dat$Ct)
new_data$dpi
data$dpi
dat$dpi
dat$dpi <- as.numeric(dat$dpi)
# Create plotting function
ci_plot <- function(data = dat,
hamsterID = 3,
swabType = "oral",
var = "Ct"){
# Subset the data
new_data <- dat[which(dat$hamsterID == hamsterID &
dat$swabType == "oral"),]
# Extract the plotting variable of interest
new_var <- new_data[,var]
# Assign x, y, and color
x <- new_data$dpi
y <- new_var
color <- new_data$color
# Plot
plot(x = x,
y = y,
col = color)
}
hamster_plot()
ci_plot()
ci_plot <- function(data = dat,
hamsterID = 3,
swabType = "oral",
var = "Ct"){
# Subset the data
new_data <- dat[which(dat$hamsterID == hamsterID &
dat$swabType == "oral"),]
# Extract the plotting variable of interest
new_var <- new_data[,var]
# Assign x, y, and color
x <- new_data$dpi
y <- new_var
color <- new_data$color
# Plot
plot(x = x,
y = y)
}
ci_plot()
plot(1:11, seq(1,6, length = 11), type = "n",
xlab="Days Post Inoculation", ylab="", # label axes
ylim = c(0, 6),main="All hamsters in 10^5 qPCR ") #axis limit
# Create plotting function
ci_plot <- function(data = dat,
hamsterID = 3,
swabType = "oral",
var = "Ct"){
# Subset the data
new_data <- dat[which(dat$hamsterID == hamsterID &
dat$swabType == "oral"),]
# Extract the plotting variable of interest
new_var <- new_data[,var]
# Assign x, y, and color
x <- new_data$dpi
y <- new_var
color <- new_data$color
}
ci_plot()
# Create plotting function
ci_plot <- function(data = dat,
hamsterID = 3,
swabType = "oral",
var = "Ct"){
# Subset the data
new_data <- dat[which(dat$hamsterID == hamsterID &
dat$swabType == "oral"),]
# Extract the plotting variable of interest
new_var <- new_data[,var]
# Assign x, y, and color
x <- new_data$dpi
y <- new_var
color <- new_data$color
# Add lines
lines(x = x,
y = y,
col = color)
}
ci_plot()
# Create plotting function
ci_plot <- function(data = dat,
hamsterID = 25,
swabType = "oral",
var = "Ct"){
# Subset the data
new_data <- dat[which(dat$hamsterID == hamsterID &
dat$swabType == "oral"),]
# Extract the plotting variable of interest
new_var <- new_data[,var]
# Assign x, y, and color
x <- new_data$dpi
y <- new_var
color <- new_data$color
# Add lines
lines(x = x,
y = y,
col = color)
}
ci_plot()
# Create plotting function
ci_plot <- function(data = dat,
hamsterID = 25,
swabType = "oral",
var = "Ct"){
# Subset the data
new_data <- dat[which(dat$hamsterID == hamsterID &
dat$swabType == "oral"),]
# Extract the plotting variable of interest
new_var <- new_data[,var]
# Assign x, y, and color
x <- new_data$dpi
y <- new_var
color <- new_data$color
# Add lines
lines(x = x,
y = y,
col = color)
print(x); print(y); print(color)
}
ci_plot()
head(dat)
hist(dat$hamsterID)
unique(sort(dat$hamsterID))
my_cols <- length(unique(dat$hamsterID))
my_cols
my_cols <- rainbow(length(unique(dat$hamsterID)))
# Assign a color to each hamster in a unique column
dat$color <- my_cols[dat$hamsterID]
# create blank plot area of an appropriate size
plot(1:11, seq(1,6, length = 11), type = "n",
xlab="Days Post Inoculation", ylab="", # label axes
ylim = c(0, 6),main="All hamsters in 10^5 qPCR ") #axis limit
# Create plotting function
ci_plot <- function(data = dat,
hamsterID = 25,
swabType = "oral",
var = "Ct"){
# Subset the data
new_data <- dat[which(dat$hamsterID == hamsterID &
dat$swabType == "oral"),]
# Extract the plotting variable of interest
new_var <- new_data[,var]
# Assign x, y, and color
x <- new_data$dpi
y <- new_var
color <- new_data$color
# Add lines
lines(x = x,
y = y,
col = color)
print(x); print(y); print(color)
}
ci_plot()
hist(dat$Ct)
# create blank plot area of an appropriate size
plot(1:11, seq(1,40, length = 11), type = "n",
xlab="Days Post Inoculation", ylab="", # label axes
ylim = c(0, 6),main="All hamsters in 10^5 qPCR ") #axis limit
# Create plotting function
ci_plot <- function(data = dat,
hamsterID = 25,
swabType = "oral",
var = "Ct"){
# Subset the data
new_data <- dat[which(dat$hamsterID == hamsterID &
dat$swabType == "oral"),]
# Extract the plotting variable of interest
new_var <- new_data[,var]
# Assign x, y, and color
x <- new_data$dpi
y <- new_var
color <- new_data$color
# Add lines
lines(x = x,
y = y,
col = color)
print(x); print(y); print(color)
}
seq(1,40, length = 11)
plot(x = c(0, 11),
y = c(0, 42), type = "n",
xlab="Days Post Inoculation", ylab="", # label axes
main="All hamsters in 10^5 qPCR ") #axis limit
# Create plotting function
ci_plot <- function(data = dat,
hamsterID = 25,
swabType = "oral",
var = "Ct"){
# Subset the data
new_data <- dat[which(dat$hamsterID == hamsterID &
dat$swabType == "oral"),]
# Extract the plotting variable of interest
new_var <- new_data[,var]
# Assign x, y, and color
x <- new_data$dpi
y <- new_var
color <- new_data$color
# Add lines
lines(x = x,
y = y,
col = color)
print(x); print(y); print(color)
}
ci_plot()
?dev
dev
dev.list()
dev.list()$RStudioGD
dev.list()["RStudioGD"]
dev.list()["RStudioGD"] > 0
dev.list()["RStudioGD"]
dev.list()["RStudioGD"] > 0
# Create plotting function
ci_plot <- function(data = dat,
hamsterID = 25,
swabType = "oral",
var = "Ct"){
# Subset the data
new_data <- dat[which(dat$hamsterID == hamsterID &
dat$swabType == "oral"),]
# Extract the plotting variable of interest
new_var <- new_data[,var]
# Assign x, y, and color
x <- new_data$dpi
y <- new_var
color <- new_data$color
# If there is not existing plot, first draw base plot
if(is.null(dev.list()["RStudioGD"])){
plot(x = c(0, 11),
y = c(0, 42), type = "n",
xlab="Days Post Inoculation", ylab="", # label axes
main="All hamsters in 10^5 qPCR ") #axis limit
}
# Add lines
lines(x = x,
y = y,
col = color)
print(x); print(y); print(color)
}
# Now that you're plotting function is created, you can
ci_plot()
ci_plot(hamsterID = 1)
ci_plot(hamsterID = 2)
ci_plot(hamsterID = 3)
ci_plot(hamsterID = 4)
ci_plot(hamsterID = 5)
?sapply
sapply(X = unique(sort(dat$hamsterID)),
FUN = function(x){
ci_plot(data = dat,
hamsterID = x,
swabType = "oral",
var = "Ct")
})
dev.off()
for (i in in unique(dat$hamsterID)){
ci_plot(hamsterID = i)
}
for (i in unique(dat$hamsterID)){
ci_plot(hamsterID = i)
}
# create blank plot area of an appropriate size
plot(x = c(0, 11),
y = c(20, 42), type = "n",
xlab="Days Post Inoculation", ylab="", # label axes
main="All hamsters in 10^5 qPCR ") #axis limit
# Create plotting function
ci_plot <- function(data = dat,
hamsterID = NULL,
swabType = "oral",
var = "Ct"){
# Subset the data
new_data <- dat[which(dat$hamsterID == hamsterID &
dat$swabType == "oral"),]
# Extract the plotting variable of interest
new_var <- new_data[,var]
# Assign x, y, and color
x <- new_data$dpi
y <- new_var
color <- new_data$color
# If there is not existing plot, first draw base plot
if(is.null(dev.list()["RStudioGD"])){
plot(x = c(0, 11),
y = c(20, 42), type = "n",
xlab="Days Post Inoculation", ylab="", # label axes
main="All hamsters in 10^5 qPCR ") #axis limit
}
# Add lines
lines(x = x,
y = y,
col = color)
}
# Now that you're plotting function is created, you can plot individual hammies
# like so
ci_plot(hamsterID = 1)
ci_plot(hamsterID = 5)
# You can also plot everything by using
# sapply
dev.off()
sapply(X = unique(sort(dat$hamsterID)),
FUN = function(x){
ci_plot(data = dat,
hamsterID = x,
swabType = "oral",
var = "Ct")
})
# I'm not a big fan of apply functions, though,
# so if it were me I'd just write a for loop
# to draw all the lines on the plot
for (i in unique(dat$hamsterID)){
ci_plot(hamsterID = i)
}
dev.off()
sapply(X = unique(sort(dat$hamsterID)),
FUN = function(x){
ci_plot(data = dat,
hamsterID = x,
swabType = "oral",
var = "Ct")
})
dev.off() # clear graphics window
dev.off()
for (i in unique(dat$hamsterID)){
ci_plot(hamsterID = i)
}
unique(dat$col)
# At the end, go ahead and add a legend
legend(x = "topright",
col = unique(dat$color),
lty = 1,
legend = dat$hamsterID[which(dat$color == unique(dat$col))],
cex = 0.5,
title = "Hamster ID")
dev.off()
for (i in unique(dat$hamsterID)){
ci_plot(hamsterID = i)
}
# At the end, go ahead and add a legend
legend(x = "topright",
col = unique(dat$color),
lty = 1,
legend = dat$hamsterID[which(dat$color == unique(dat$color))],
cex = 0.5,
title = "Hamster ID")
legend_dat <- dat[!duplicated(dat$hamsterID),]
dev.off()
for (i in unique(dat$hamsterID)){
ci_plot(hamsterID = i)
}
# At the end, go ahead and add a legend
legend_dat <- dat[!duplicated(dat$hamsterID),]
legend(x = "topright",
col = legend_dat$color,
lty = 1,
legend = legend_dat$hamsterID,
cex = 0.5,
title = "Hamster ID")
rm(legend_dat)
dev.off()
for (i in unique(dat$hamsterID)){
ci_plot(hamsterID = i)
}
# At the end, go ahead and add a legend
legend_dat <- dat[!duplicated(dat$hamsterID),]
legend_dat <- legend_dat[order(legend_dat$hamsterID),]
legend(x = "topright",
col = legend_dat$color,
lty = 1,
legend = legend_dat$hamsterID,
cex = 0.5,
title = "Hamster ID")
rm(legend_dat)
dev.off()
for (i in unique(dat$hamsterID)){
ci_plot(hamsterID = i)
}
# At the end, go ahead and add a legend
legend_dat <- dat[!duplicated(dat$hamsterID),]
legend_dat <- legend_dat[order(legend_dat$hamsterID),]
legend(x = "topright",
col = legend_dat$color,
lty = 1,
legend = legend_dat$hamsterID,
cex = 0.5,
title = "Hamster ID",
ncol = 2)
rm(legend_dat)
dat$color <- adjustcolor(dat$color, alpha.f = 0.6)
# create blank plot area of an appropriate size
plot(x = c(0, 11),
y = c(20, 42), type = "n",
xlab="Days Post Inoculation", ylab="", # label axes
main="All hamsters in 10^5 qPCR ") #axis limit
# Create plotting function
ci_plot <- function(data = dat,
hamsterID = NULL,
swabType = "oral",
var = "Ct"){
# Subset the data
new_data <- dat[which(dat$hamsterID == hamsterID &
dat$swabType == "oral"),]
# Extract the plotting variable of interest
new_var <- new_data[,var]
# Assign x, y, and color
x <- new_data$dpi
y <- new_var
color <- new_data$color
# If there is not existing plot, first draw base plot
if(is.null(dev.list()["RStudioGD"])){
plot(x = c(0, 11),
y = c(20, 42), type = "n",
xlab="Days Post Inoculation", ylab="", # label axes
main="All hamsters in 10^5 qPCR ") #axis limit
}
# Add lines
lines(x = x,
y = y,
col = color)
}
# like so
ci_plot(hamsterID = 1)
ci_plot(hamsterID = 5)
ci_plot(hamsterID = 1)
ci_plot(hamsterID = 2)
ci_plot(hamsterID = 3)
ci_plot(hamsterID = 4)
ci_plot(hamsterID = 5)
dev.off()
for (i in unique(dat$hamsterID)){
ci_plot(hamsterID = i)
}
# At the end, go ahead and add a legend
legend_dat <- dat[!duplicated(dat$hamsterID),]
legend_dat <- legend_dat[order(legend_dat$hamsterID),]
legend(x = "topright",
col = legend_dat$color,
lty = 1,
legend = legend_dat$hamsterID,
cex = 0.5,
title = "Hamster ID",
ncol = 2)
rm(legend_dat)
sapply(X = unique(sort(dat$hamsterID)),
FUN = function(x){
ci_plot(data = dat,
hamsterID = x,
swabType = "oral",
var = "Ct")
})
